# q0è°ƒå‚ç»“æœä¸ä¸‹ä¸€æ­¥è®¡åˆ’

**æœ€åæ›´æ–°**ï¼š2025-12-15

---

## âœ… è°ƒå‚ç»“æœæ€»ç»“

### å¿«é€Ÿæ¨¡å¼è°ƒå‚ï¼ˆå·²å®Œæˆï¼‰

**æ‰§è¡Œæ—¶é—´**ï¼š2025-12-15  
**æœç´¢æ¨¡å¼**ï¼šfastï¼ˆ12ç§ç»„åˆï¼‰  
**è¯„ä¼°æ•°æ®é›†**ï¼šdev.jsonlï¼ˆ4,948æ¡æ ·æœ¬ï¼‰

**æœ€ä¼˜å‚æ•°**ï¼š
- `max_sensitive_prob`: 0.85
- `base_sensitive_prob`: 0.15
- **æœ€ä¼˜F1**: 52.70%

---

### ç²¾ç»†æ¨¡å¼è°ƒå‚ï¼ˆå·²å®Œæˆï¼‰â­

**æ‰§è¡Œæ—¶é—´**ï¼š2025-12-15  
**æœç´¢æ¨¡å¼**ï¼šrefinedï¼ˆ25ç§ç»„åˆï¼‰  
**è¯„ä¼°æ•°æ®é›†**ï¼šdev.jsonlï¼ˆ4,948æ¡æ ·æœ¬ï¼‰

**æœ€ä¼˜å‚æ•°**ï¼š

```yaml
q0:
  min_matches_for_sensitive: 1      # å›ºå®šï¼ˆå·²ç¡®è®¤æœ€ä¼˜ï¼‰
  max_sensitive_prob: 0.82          # ç²¾ç»†æœç´¢å‘ç°ï¼ˆä»0.85å¾®è°ƒï¼‰
  base_sensitive_prob: 0.17         # ç²¾ç»†æœç´¢å‘ç°ï¼ˆä»0.15å¾®è°ƒï¼‰
  porn_weight: 1.0                 # ä¿æŒ
  politics_weight: 0.6              # ä¿æŒ
  abuse_weight: 0.5                # ä¿æŒ
```

**æœ€ä¼˜F1**: 52.70%ï¼ˆä¸å¿«é€Ÿæ¨¡å¼ç»“æœä¸€è‡´ï¼‰

### ç²¾ç»†æ¨¡å¼Top 5å‚æ•°ç»„åˆ

æ‰€æœ‰Top 5ç»„åˆçš„F1éƒ½æ˜¯**52.70%**ï¼ˆæ€§èƒ½å¹³å°å¹³å¦ï¼‰ï¼š

1. **F1=52.70%** â­ï¼ˆæœ€ä¼˜ï¼‰
   - max_prob=0.82, base_prob=0.17
   - Precision=86.13%, Recall=37.96%

2. **F1=52.70%**
   - max_prob=0.87, base_prob=0.15

3. **F1=52.70%**
   - max_prob=0.87, base_prob=0.13

4. **F1=52.70%**
   - max_prob=0.85, base_prob=0.18

5. **F1=52.70%**
   - max_prob=0.87, base_prob=0.12

### æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | ä¿®å¤å | å¿«é€Ÿæ¨¡å¼ | ç²¾ç»†æ¨¡å¼ | è¯„ä¼° |
|------|--------|---------|---------|------|
| **Precision** | 86.48% | 86.13% | **86.13%** | âœ… ä¿æŒç¨³å®š |
| **Recall** | 35.31% | 37.96% | **37.96%** | âœ… æ˜¾è‘—æå‡ |
| **F1** | 50.14% | 52.70% | **52.70%** | âš ï¸ æå‡ä½†æœªè¾¾ç›®æ ‡55% |
| **Accuracy** | 54.51% | 55.84% | **55.84%** | âœ… æ”¹å–„ |
| **å¹³å‡æ•æ„Ÿæ¦‚ç‡** | 0.2584 | 0.3267 | **0.3267** | âœ… æ›´åˆç† |

### Top 3 å‚æ•°ç»„åˆ

1. **F1=52.70%** â­ï¼ˆæœ€ä¼˜ï¼‰
   - min_matches=1, max_prob=0.85, base_prob=0.15
   - Precision=86.13%, Recall=37.96%

2. **F1=52.55%**
   - min_matches=1, max_prob=0.85, base_prob=0.1
   - Precision=86.14%, Recall=37.80%

3. **F1=51.78%**
   - min_matches=1, max_prob=0.75, base_prob=0.15
   - Precision=86.43%, Recall=36.96%

### å…³é”®å‘ç°

1. **min_matches=1 ä¼˜äº min_matches=2** âœ…
   - å¬å›ç‡æ˜¾è‘—æ›´é«˜ï¼ˆ37.96% vs 23.67%ï¼‰
   - Precisionç•¥æœ‰ä¸‹é™ä½†ä»åœ¨å¯æ¥å—èŒƒå›´ï¼ˆ86.13% vs 87.14%ï¼‰
   - **ç»“è®º**ï¼šå›ºå®šä¸º1

2. **æ€§èƒ½å¹³å°å¹³å¦** âš ï¸
   - ç²¾ç»†æ¨¡å¼å‘ç°å¤šä¸ªå‚æ•°ç»„åˆéƒ½è¾¾åˆ°ç›¸åŒçš„F1ï¼ˆ52.70%ï¼‰
   - max_sensitive_probåœ¨[0.82, 0.87]èŒƒå›´å†…è¡¨ç°ç›¸åŒ
   - base_sensitive_probåœ¨[0.12, 0.18]èŒƒå›´å†…è¡¨ç°ç›¸åŒ
   - **ç»“è®º**ï¼š52.70%å¯èƒ½å·²ç»æ˜¯rule-basedæ–¹æ³•åœ¨æ­¤æ•°æ®é›†ä¸Šçš„æ€§èƒ½ä¸Šé™

3. **æœ€ä¼˜å‚æ•°å¾®è°ƒ**
   - å¿«é€Ÿæ¨¡å¼ï¼šmax=0.85, base=0.15
   - ç²¾ç»†æ¨¡å¼ï¼šmax=0.82, base=0.17
   - F1ç›¸åŒï¼Œè¯´æ˜å‚æ•°åœ¨è¾ƒå¤§èŒƒå›´å†…éƒ½å¾ˆç¨³å®š

4. **rule-basedæ–¹æ³•å›ºæœ‰å±€é™**
   - æ— æ³•çªç ´52.70%çš„F1ä¸Šé™
   - ä¸»è¦åŸå› ï¼šè¯è¡¨è¦†ç›–ç‡æœ‰é™ï¼ˆRecallä¸Šé™çº¦38%ï¼‰
   - æå‡ç©ºé—´æœ‰é™ï¼Œéœ€è¦æ›´é«˜çº§çš„æ–¹æ³•ï¼ˆå¦‚PKRIï¼‰

---

## ğŸ“Š æ€§èƒ½åˆ†æ

### ä¸ºä»€ä¹ˆF1åªæœ‰52.70%ï¼Ÿ

è¿™æ˜¯**rule-basedæ–¹æ³•çš„å›ºæœ‰å±€é™**ï¼š

1. **Recallä¸Šé™**ï¼šåªèƒ½åŒ¹é…è¯è¡¨ä¸­çš„è¯ï¼Œæ— æ³•æ³›åŒ–åˆ°æ–°è¯æˆ–å˜ä½“
2. **Precision-Recallæƒè¡¡**ï¼šæé«˜Recallä¼šé™ä½Precision
3. **è¯è¡¨è§„æ¨¡é™åˆ¶**ï¼šè¯è¡¨å·²ä¼˜åŒ–ï¼ˆåˆ é™¤83.7%å™ªå£°è¯ï¼‰ï¼Œæ‰©å±•ç©ºé—´æœ‰é™

**ç»“è®º**ï¼š52.70%çš„F1å¯¹rule-basedæ–¹æ³•å·²å±åˆç†ï¼Œè¿™æ˜¯q0çš„é¢„æœŸæ€§èƒ½èŒƒå›´ã€‚

### q0åœ¨EMGä¸­çš„ä½œç”¨

q0ä¸æ˜¯ç‹¬ç«‹çš„åˆ†ç±»å™¨ï¼Œè€Œæ˜¯**çŸ¥è¯†å…ˆéªŒæä¾›è€…**ï¼š

- **ä½œç”¨**ï¼šåœ¨æ¨¡å‹ä¸ç¡®å®šæ—¶æä¾›çŸ¥è¯†å…ˆéªŒ
- **æƒé‡**ï¼šåœ¨EMGèåˆä¸­ï¼Œæ¨¡å‹ä»å ä¸»å¯¼ï¼ˆÎ±é€šå¸¸>0.5ï¼‰
- **è¯„ä¼°æ ‡å‡†**ï¼šåº”å…³æ³¨EMGæœ€ç»ˆæ•ˆæœï¼Œè€Œéq0ç‹¬ç«‹F1

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### é€‰é¡¹Aï¼šåº”ç”¨æœ€ä¼˜å‚æ•°å¹¶éªŒè¯EMGæ•ˆæœï¼ˆæ¨èï¼‰â­

**æ­¥éª¤**ï¼š

1. **æ›´æ–°config.yaml**
   ```yaml
   q0:
     max_sensitive_prob: 0.85      # ä»0.75æ›´æ–°
     base_sensitive_prob: 0.15     # ä»0.1æ›´æ–°
     min_matches_for_sensitive: 1  # ä¿æŒ
   ```

2. **é‡æ–°ç”Ÿæˆq0**
   ```bash
   python scripts/q0_builder.py --datasets train dev test
   ```

3. **é‡æ–°è¿è¡ŒDay7ï¼ˆÎ±*æœç´¢ï¼‰**
   ```bash
   python scripts/emg_bucket_search.py \
       --baseline-file output/dev_with_uncertainty.jsonl \
       --q0-file data/q0_dev.jsonl \
       --bucket-file output/dev_uncertainty_buckets.csv \
       --output-dir output
   ```

4. **é‡æ–°è¿è¡ŒDay8ï¼ˆÎ±(u)æ‹Ÿåˆï¼‰**
   ```bash
   python scripts/emg_fit_alpha_u.py \
       --bucket-alpha-file output/bucket_alpha_star.csv \
       --output-dir output
   ```

5. **é‡æ–°è¿è¡ŒDay9ï¼ˆEMGè¯„ä¼°ï¼‰**
   ```bash
   python scripts/eval_emg.py \
       --baseline-file output/test_with_uncertainty.jsonl \
       --q0-file data/q0_test.jsonl \
       --alpha-u-lut output/alpha_u_lut.json \
       --use-consistency-gating
   ```

**é¢„æœŸæ”¶ç›Š**ï¼š
- éªŒè¯ä¼˜åŒ–åçš„q0æ˜¯å¦èƒ½æ”¹å–„EMGæœ€ç»ˆæ•ˆæœ
- æ£€æŸ¥Î±*åˆ†å¸ƒæ˜¯å¦æ›´ç¬¦åˆç†è®ºé¢„æœŸï¼ˆé«˜uæ—¶Î±*é™ä½ï¼‰
- éªŒè¯EMGçš„F1ã€NLLã€ECEæ˜¯å¦æ”¹å–„

**é¢„è®¡è€—æ—¶**ï¼š2-3å°æ—¶

---

### é€‰é¡¹Bï¼šè¿è¡Œç²¾ç»†æ¨¡å¼è°ƒå‚ï¼ˆæ¨èï¼‰â­

**é€‚ç”¨åœºæ™¯**ï¼š
- åœ¨å¿«é€Ÿæ¨¡å¼æ‰¾åˆ°æœ€ä¼˜å€¼åï¼Œå¸Œæœ›è¿›è¡Œæ›´ç²¾ç»†çš„æœç´¢
- ç¼©å°æœç´¢èŒƒå›´ï¼Œæé«˜ç»†ç²’åº¦

**æ‰§è¡Œæ–¹å¼**ï¼š
```bash
python scripts/q0_hyperparameter_search.py \
    --dataset-file data/dev.jsonl \
    --baseline-file output/dev_with_uncertainty.jsonl \
    --lexicon-dir configs/lexicons \
    --mode refined \
    --output-dir output
```

**æœç´¢ç©ºé—´**ï¼š
- **25ç§å‚æ•°ç»„åˆ**ï¼ˆå›´ç»•æœ€ä¼˜å€¼ç²¾ç»†æœç´¢ï¼‰
- `min_matches_for_sensitive`: [1]ï¼ˆå›ºå®šï¼Œå·²ç¡®è®¤æœ€ä¼˜ï¼‰
- `max_sensitive_prob`: [0.80, 0.82, 0.85, 0.87, 0.90]ï¼ˆå›´ç»•0.85ï¼Œæ­¥é•¿0.02ï¼‰
- `base_sensitive_prob`: [0.12, 0.13, 0.15, 0.17, 0.18]ï¼ˆå›´ç»•0.15ï¼Œæ­¥é•¿0.01-0.02ï¼‰

**é¢„è®¡è€—æ—¶**ï¼š30-60åˆ†é’Ÿ

**é¢„æœŸæ”¶ç›Š**ï¼š
- å¯èƒ½åœ¨æœ€ä¼˜å€¼é™„è¿‘æ‰¾åˆ°æ›´ç²¾ç»†çš„æœ€ä¼˜å‚æ•°
- èŒƒå›´ç¼©å°ä½†ç»†ç²’åº¦æ›´é«˜ï¼Œæ›´å®¹æ˜“æ‰¾åˆ°å±€éƒ¨æœ€ä¼˜

**å»ºè®®**ï¼šå…ˆæ‰§è¡Œé€‰é¡¹AéªŒè¯EMGæ•ˆæœï¼Œç„¶åæ‰§è¡Œé€‰é¡¹Bè¿›è¡Œç²¾ç»†è°ƒå‚ã€‚

---

### é€‰é¡¹Cï¼šè¿è¡Œå®Œæ•´æ¨¡å¼è°ƒå‚ï¼ˆå¯é€‰ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- å¦‚æœç²¾ç»†æ¨¡å¼æ•ˆæœä»ä¸ç†æƒ³
- å¦‚æœå¸Œæœ›æ¢ç´¢æ›´å¹¿æ³›çš„å‚æ•°ç©ºé—´

**æ‰§è¡Œæ–¹å¼**ï¼š
```bash
python scripts/q0_hyperparameter_search.py \
    --dataset-file data/dev.jsonl \
    --baseline-file output/dev_with_uncertainty.jsonl \
    --lexicon-dir configs/lexicons \
    --mode full \
    --output-dir output
```

**æœç´¢ç©ºé—´**ï¼š
- 384ç§å‚æ•°ç»„åˆ
- åŒ…æ‹¬æ‰€æœ‰å…³é”®å‚æ•°çš„å®Œæ•´æœç´¢

**é¢„è®¡è€—æ—¶**ï¼š6-12å°æ—¶

**é¢„æœŸæ”¶ç›Š**ï¼š
- å¯èƒ½æ‰¾åˆ°æ›´ä¼˜å‚æ•°ç»„åˆ
- ä½†æå‡å¯èƒ½æœ‰é™ï¼ˆrule-basedæ–¹æ³•å›ºæœ‰å±€é™ï¼‰

**å»ºè®®**ï¼šå…ˆæ‰§è¡Œé€‰é¡¹Aå’ŒBï¼Œå¦‚æœæ•ˆæœä»ä¸ç†æƒ³å†è€ƒè™‘é€‰é¡¹Cã€‚

---

### é€‰é¡¹Cï¼šæ¥å—å½“å‰ç»“æœï¼ˆåˆç†é€‰æ‹©ï¼‰

**ç†ç”±**ï¼š
- q0 F1=52.70%å¯¹rule-basedæ–¹æ³•å·²å±åˆç†
- ç›¸æ¯”åˆå§‹çŠ¶æ€ï¼ˆ30.44%ï¼‰æå‡73%ï¼Œæ”¹å–„æ˜¾è‘—
- Precisionä¿æŒ86%ä»¥ä¸Šï¼Œè´¨é‡å¯é 
- åœ¨EMGèåˆä¸­ï¼Œq0åªæ˜¯è¾…åŠ©ï¼Œæ¨¡å‹ä»å ä¸»å¯¼

**é€‚ç”¨åœºæ™¯**ï¼š
- å¦‚æœæ—¶é—´æœ‰é™
- å¦‚æœå½“å‰q0è´¨é‡å·²æ»¡è¶³EMGéœ€æ±‚
- å¦‚æœå¸Œæœ›å°†ç²¾åŠ›æŠ•å…¥åˆ°å…¶ä»–ä¼˜åŒ–æ–¹å‘ï¼ˆå¦‚PKRIï¼‰

---

## ğŸ“ è°ƒå‚ç»“æœæ–‡ä»¶

è°ƒå‚ç»“æœå·²ä¿å­˜åˆ°ï¼š
- `output/q0_param_search_results.csv`ï¼šæ‰€æœ‰12ç§ç»„åˆçš„è¯¦ç»†ç»“æœ
- `output/q0_best_params.json`ï¼šæœ€ä¼˜å‚æ•°JSONæ ¼å¼

**æŸ¥çœ‹ç»“æœ**ï¼š
```bash
# æŸ¥çœ‹æœ€ä¼˜å‚æ•°
cat output/q0_best_params.json

# æŸ¥çœ‹æ‰€æœ‰ç»“æœï¼ˆTop 10ï¼‰
head -11 output/q0_param_search_results.csv | column -t -s,
```

---

## ğŸ” è¿›ä¸€æ­¥ä¼˜åŒ–æ–¹å‘ï¼ˆå¦‚æœé€‰é¡¹Aæ•ˆæœä¸ç†æƒ³ï¼‰

### P1ï¼šè¯è¡¨ä¼˜åŒ–
- å¦‚æœRecallä»ä¸è¶³ï¼Œè€ƒè™‘æ¢å¤éƒ¨åˆ†è¢«åˆ çš„è¯
- ä½¿ç”¨æ›´ä¿å®ˆçš„è¯è¡¨ä¼˜åŒ–ç­–ç•¥
- åˆ†ææ¼æ£€æ ·æœ¬ï¼Œè¡¥å……å…³é”®è¯

### P2ï¼šæ¦‚ç‡è®¡ç®—ç­–ç•¥æ”¹è¿›
- è€ƒè™‘è¯é¢‘ã€PMIã€è¯å¯†åº¦ç­‰ç‰¹å¾
- æ”¹è¿›åŒ¹é…æƒé‡è®¡ç®—
- å°è¯•æ›´ç²¾ç»†çš„æ¦‚ç‡æ˜ å°„å‡½æ•°

### P3ï¼šPKRIæ›¿ä»£æ–¹æ¡ˆ
- å¦‚æœq0æ€§èƒ½æ— æ³•è¿›ä¸€æ­¥æå‡ï¼Œè€ƒè™‘ä½¿ç”¨q_PKRI
- PKRIæ˜¯å­¦ä¹ å‹æ–¹æ³•ï¼Œå¯èƒ½çªç ´rule-basedçš„å±€é™

---

## âœ… å»ºè®®

**æ¨èæ‰§è¡Œé¡ºåº**ï¼š

1. **ç«‹å³æ‰§è¡Œé€‰é¡¹A**ï¼šåº”ç”¨æœ€ä¼˜å‚æ•°ï¼ŒéªŒè¯EMGæ•ˆæœ
2. **æ ¹æ®ç»“æœå†³å®š**ï¼š
   - å¦‚æœEMGæ•ˆæœæ”¹å–„ â†’ å®Œæˆï¼Œæ¥å—å½“å‰ç»“æœ
   - å¦‚æœEMGæ•ˆæœä¸ç†æƒ³ â†’ è€ƒè™‘é€‰é¡¹Bï¼ˆå®Œæ•´æ¨¡å¼ï¼‰æˆ–P1-P3ä¼˜åŒ–æ–¹å‘

**æ—¶é—´å®‰æ’**ï¼š
- é€‰é¡¹Aï¼š2-3å°æ—¶ï¼ˆæ¨èå…ˆæ‰§è¡Œï¼‰
- é€‰é¡¹Bï¼š6-12å°æ—¶ï¼ˆå¯é€‰ï¼Œæ ¹æ®é€‰é¡¹Aç»“æœå†³å®šï¼‰

---

**æœ€åæ›´æ–°**ï¼š2025-12-15

